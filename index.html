<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIP NEW YEAR 2026 - FORTUNE TELLER</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Montserrat:wght@300;400;800&family=Orbitron:wght@500&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #FFD700;
            --red: #D2042D;
            --bg: #020202;
            --glass: rgba(20, 20, 20, 0.8);
            --neon-blue: #00f3ff;
            --neon-pink: #bc13fe;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            background: var(--bg);
            color: #fff;
            font-family: 'Montserrat', sans-serif;
            overflow: hidden; /* Chặn thanh cuộn */
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* --- CANVAS PHÁO HOA --- */
        #canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            filter: contrast(1.2) brightness(1.2);
        }

        /* --- MÀN HÌNH CHÀO MỪNG (NHẬP TÊN) --- */
        #welcome-screen {
            position: absolute;
            z-index: 100;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 1s ease;
        }

        .input-box {
            background: rgba(255, 255, 255, 0.05);
            padding: 40px;
            border-radius: 20px;
            border: 1px solid var(--gold);
            backdrop-filter: blur(10px);
            text-align: center;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.2);
            max-width: 90%;
            width: 400px;
            transform: scale(1);
            transition: transform 0.3s;
        }
        
        .input-box:hover { transform: scale(1.02); }

        .input-box h2 {
            font-family: 'Dancing Script', cursive;
            color: var(--gold);
            font-size: 2.5rem;
            margin-bottom: 20px;
        }

        .form-group { margin-bottom: 20px; text-align: left; }
        .form-group label { display: block; margin-bottom: 5px; color: #aaa; font-size: 0.9rem; }
        
        input {
            width: 100%;
            padding: 12px;
            background: rgba(0,0,0,0.5);
            border: 1px solid #333;
            border-radius: 5px;
            color: #fff;
            font-size: 1rem;
            outline: none;
            transition: 0.3s;
        }
        input:focus { border-color: var(--gold); box-shadow: 0 0 10px var(--gold); }

        button.btn-start {
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, var(--red), #800000);
            border: none;
            color: white;
            font-weight: bold;
            font-size: 1.1rem;
            border-radius: 5px;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 2px;
            box-shadow: 0 0 15px var(--red);
            transition: 0.3s;
        }
        button.btn-start:hover {
            background: linear-gradient(45deg, #800000, var(--red));
            box-shadow: 0 0 30px var(--red);
            transform: translateY(-2px);
        }

        /* --- MÀN HÌNH CHÍNH --- */
        #main-screen {
            display: none; /* Ẩn mặc định */
            position: relative;
            z-index: 10;
            text-align: center;
            width: 100%;
            max-width: 800px;
            opacity: 0;
            animation: fadeIn 2s forwards;
        }

        @keyframes fadeIn { to { opacity: 1; } }

        .vip-name {
            font-family: 'Dancing Script', cursive;
            font-size: 4rem;
            background: linear-gradient(to right, #fff, var(--gold), #fff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 20px rgba(255,215,0,0.5);
            margin-bottom: 10px;
        }

        .element-badge {
            display: inline-block;
            padding: 5px 20px;
            border: 1px solid var(--gold);
            border-radius: 50px;
            color: var(--gold);
            text-transform: uppercase;
            font-size: 0.9rem;
            margin-bottom: 30px;
            background: rgba(0,0,0,0.6);
            letter-spacing: 2px;
        }

        .wish-container {
            background: rgba(0, 0, 0, 0.6);
            padding: 30px;
            border-radius: 15px;
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
            position: relative;
            overflow: hidden;
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .wish-container::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            border-radius: 15px;
            box-shadow: inset 0 0 20px var(--gold);
            opacity: 0.3;
            pointer-events: none;
        }

        #typewriter-text {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.4rem;
            line-height: 1.6;
            color: #fff;
            font-weight: 400;
        }

        .year-display {
            font-family: 'Orbitron', sans-serif;
            font-size: 6rem;
            font-weight: 900;
            color: rgba(255,255,255,0.05);
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: -1;
            pointer-events: none;
            white-space: nowrap;
        }

        .control-panel {
            margin-top: 30px;
        }

        .btn-restart {
            background: transparent;
            border: 1px solid #fff;
            color: #fff;
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            transition: 0.3s;
        }
        .btn-restart:hover { background: #fff; color: #000; }

        /* Responsive */
        @media (max-width: 600px) {
            .vip-name { font-size: 2.5rem; }
            #typewriter-text { font-size: 1.1rem; }
            .year-display { font-size: 4rem; }
        }
    </style>
</head>
<body>

    <canvas id="canvas"></canvas>

    <div id="welcome-screen">
        <div class="input-box">
            <h2>Gieo Quẻ Đầu Năm</h2>
            <div class="form-group">
                <label>Quý danh của bạn:</label>
                <input type="text" id="userName" placeholder="Ví dụ: Hoàng Tuấn" autocomplete="off">
            </div>
            <div class="form-group">
                <label>Năm sinh (Dương lịch):</label>
                <input type="number" id="birthYear" placeholder="Ví dụ: 1998" min="1900" max="2026">
            </div>
            <button class="btn-start" onclick="startExperience()">Xem Lời Chúc VIP</button>
        </div>
        <p style="margin-top: 20px; font-size: 0.8rem; color: #666;">Nhập năm sinh để AI tính mệnh Ngũ Hành</p>
    </div>

    <div id="main-screen">
        <div class="year-display">2026</div>
        <h1 class="vip-name" id="display-name">Chào Bạn</h1>
        <div class="element-badge" id="display-element">MỆNH: ...</div>

        <div class="wish-container">
            <p id="typewriter-text"></p>
        </div>

        <div class="control-panel">
            <button class="btn-restart" onclick="location.reload()">↺ Nhập lại thông tin</button>
        </div>
    </div>

    <script>
        // --- 1. FIREWORKS ENGINE (PHYSICS NÂNG CAO) ---
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let fireworks = [];
        let particles = [];

        // Hàm tạo màu ngẫu nhiên rực rỡ
        function randomColor() {
            const colors = [
                '#ff0000', '#ffd700', '#ff00ff', '#00ff00', '#00ffff', '#ffffff', 
                '#ff4500', '#7fff00', '#1e90ff'
            ];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        class Firework {
            constructor(sx, sy, tx, ty) {
                this.x = sx;
                this.y = sy;
                this.sx = sx;
                this.sy = sy;
                this.tx = tx;
                this.ty = ty;
                this.distanceToTarget = Math.sqrt(Math.pow(tx - sx, 2) + Math.pow(ty - sy, 2));
                this.distanceTraveled = 0;
                this.coordinates = [];
                this.coordinateCount = 3;
                while (this.coordinateCount--) {
                    this.coordinates.push([this.x, this.y]);
                }
                this.angle = Math.atan2(ty - sy, tx - sx);
                this.speed = 2;
                this.acceleration = 1.05;
                this.brightness = Math.random() * 50 + 50;
                this.targetRadius = 1;
                this.color = randomColor();
            }

            update(index) {
                this.coordinates.pop();
                this.coordinates.unshift([this.x, this.y]);

                if (this.targetRadius < 8) this.targetRadius += 0.3;
                else this.targetRadius = 1;

                this.speed *= this.acceleration;
                const vx = Math.cos(this.angle) * this.speed;
                const vy = Math.sin(this.angle) * this.speed;
                
                this.distanceTraveled = Math.sqrt(Math.pow(this.x - this.sx, 2) + Math.pow(this.y - this.sy, 2));

                if (this.distanceTraveled >= this.distanceToTarget) {
                    createParticles(this.tx, this.ty, this.color);
                    fireworks.splice(index, 1);
                } else {
                    this.x += vx;
                    this.y += vy;
                }
            }

            draw() {
                ctx.beginPath();
                ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
                ctx.lineTo(this.x, this.y);
                ctx.strokeStyle = this.color;
                ctx.lineWidth = 3; // Đuôi pháo hoa dày hơn
                ctx.stroke();
            }
        }

        class Particle {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                this.coordinates = [];
                this.coordinateCount = 5;
                while (this.coordinateCount--) {
                    this.coordinates.push([this.x, this.y]);
                }
                this.angle = Math.random() * Math.PI * 2;
                this.speed = Math.random() * 10 + 1;
                this.friction = 0.95;
                this.gravity = 1;
                this.hue = Math.random() * 360;
                this.brightness = Math.random() * 50 + 50;
                this.alpha = 1;
                this.decay = Math.random() * 0.015 + 0.015;
                this.baseColor = color;
            }

            update(index) {
                this.coordinates.pop();
                this.coordinates.unshift([this.x, this.y]);
                this.speed *= this.friction;
                this.x += Math.cos(this.angle) * this.speed;
                this.y += Math.sin(this.angle) * this.speed + this.gravity;
                this.alpha -= this.decay;

                if (this.alpha <= this.decay) {
                    particles.splice(index, 1);
                }
            }

            draw() {
                ctx.beginPath();
                ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
                ctx.lineTo(this.x, this.y);
                // Hiệu ứng màu lấp lánh
                ctx.strokeStyle = `hsla(${this.hue}, 100%, ${this.brightness}%, ${this.alpha})`;
                ctx.lineWidth = 2;
                ctx.stroke();
            }
        }

        function createParticles(x, y, color) {
            let particleCount = 150; // Số lượng hạt nổ nhiều hơn
            while (particleCount--) {
                particles.push(new Particle(x, y, color));
            }
        }

        function loop() {
            requestAnimationFrame(loop);
            // Tạo hiệu ứng đuôi mờ (motion trail)
            ctx.globalCompositeOperation = 'destination-out';
            ctx.fillStyle = 'rgba(0, 0, 0, 0.2)'; 
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.globalCompositeOperation = 'lighter';

            let i = fireworks.length;
            while (i--) {
                fireworks[i].draw();
                fireworks[i].update(i);
            }

            let j = particles.length;
            while (j--) {
                particles[j].draw();
                particles[j].update(j);
            }

            // Tự động bắn pháo hoa ngẫu nhiên
            if (activeFireworks) {
                if (Math.random() < 0.08) { // Tốc độ bắn nhanh
                    let sx = Math.random() * canvas.width;
                    let sy = canvas.height;
                    let tx = Math.random() * canvas.width;
                    let ty = Math.random() * (canvas.height / 2);
                    fireworks.push(new Firework(sx, sy, tx, ty));
                }
            }
        }

        let activeFireworks = false; // Chỉ bắn khi bắt đầu
        loop();

        // --- 2. LOGIC TÍNH MỆNH & LỜI CHÚC VIP ---
        
        // Data lời chúc theo Mệnh
        const wishesDB = {
            "KIM": "Năm 2026 mệnh Kim của bạn sẽ tỏa sáng rực rỡ. Tiền vào như nước, vàng bạc đầy kho. Những dự án đầu tư sẽ sinh lời gấp bội. Hãy giữ cái đầu lạnh và trái tim nóng!",
            "MỘC": "Như cây đại thụ giữa rừng già, năm Bính Ngọ sự nghiệp của bạn sẽ phát triển vững chãi, vươn cao. Quý nhân phù trợ, sức khỏe dồi dào, gia đạo xanh tươi hạnh phúc.",
            "THỦY": "Năm nay tài lộc của bạn sẽ trôi chảy, linh hoạt như dòng nước lớn. Mọi khó khăn đều bị cuốn trôi, mở đường cho những cơ hội thăng tiến bất ngờ và tình duyên thắm thiết.",
            "HỎA": "Một năm rực lửa đam mê! Năng lượng của bạn sẽ thiêu đốt mọi rào cản. Danh tiếng vang xa, công danh rạng rỡ. Bạn sẽ là ngôi sao sáng nhất trong lĩnh vực của mình.",
            "THỔ": "Vững như bàn thạch! Năm 2026 là năm bạn tích lũy tài sản cực lớn. Đất sinh ra vàng, mọi sự kiên trì của bạn sẽ đơm hoa kết trái. Một năm an yên và thịnh vượng."
        };

        const generalWishes = [
            "Năm Bính Ngọ - Mã Đáo Thành Công! Chúc bạn bứt phá mọi giới hạn.",
            "2026 rực rỡ! Chúc bạn một năm sức khỏe vô địch, tiền tài vô biên.",
            "Chúc mừng năm mới! Tấn tài tấn lộc, vạn sự như ý."
        ];

        function getElement(year) {
            // Công thức tính mệnh đơn giản (Can + Chi)
            // Can: lấy số cuối năm sinh. Chi: lấy năm sinh chia dư 12
            // Quy ước đơn giản cho code ngắn gọn (dựa trên Thiên Can)
            const can = year % 10;
            // Map tương đối số cuối năm sinh ra ngũ hành (Mẹo phong thủy nhanh)
            // 4,5: Hỏa | 6,7: Thổ | 8,9: Kim | 0,1: Kim/Thủy | 2,3: Thủy/Mộc
            // Để chính xác và đơn giản cho game vui, ta dùng mảng map fixed:
            const elements = [
                "KIM", "KIM", "THỦY", "THỦY", "HỎA", 
                "HỎA", "THỔ", "THỔ", "MỘC", "MỘC"
            ];
            // Lưu ý: Đây là map đơn giản hóa theo Can để demo.
            // Nếu muốn chính xác 100% nạp âm cần thuật toán dài hơn.
            // Ở đây dùng thuật toán Random có trọng số dựa trên Can để tạo bất ngờ.
            return elements[can];
        }

        function typeWriter(text, i, fnCallback) {
            if (i < text.length) {
                document.getElementById("typewriter-text").innerHTML = text.substring(0, i+1) + '<span aria-hidden="true">|</span>';
                setTimeout(function() {
                    typeWriter(text, i + 1, fnCallback)
                }, 30); // Tốc độ gõ chữ
            } else if (typeof fnCallback == 'function') {
                fnCallback();
            }
        }

        function startExperience() {
            const name = document.getElementById('userName').value || "Người Bí Ẩn";
            const year = document.getElementById('birthYear').value;

            if (!year) {
                alert("Vui lòng nhập năm sinh để thầy AI gieo quẻ!");
                return;
            }

            // 1. Ẩn màn hình chào
            const welcomeScreen = document.getElementById('welcome-screen');
            welcomeScreen.style.opacity = '0';
            setTimeout(() => { welcomeScreen.style.display = 'none'; }, 1000);

            // 2. Hiện màn hình chính
            const mainScreen = document.getElementById('main-screen');
            mainScreen.style.display = 'block';

            // 3. Kích hoạt pháo hoa
            activeFireworks = true;
            
            // Bắn một loạt pháo hoa mở màn
            for(let k=0; k<10; k++) {
                setTimeout(() => {
                    fireworks.push(new Firework(
                        Math.random() * canvas.width, 
                        canvas.height, 
                        Math.random() * canvas.width, 
                        Math.random() * (canvas.height/2)
                    ));
                }, k * 200);
            }

            // 4. Xử lý nội dung
            document.getElementById('display-name').innerText = `Chúc Mừng ${name}`;
            
            const element = getElement(parseInt(year));
            document.getElementById('display-element').innerText = `BẢN MỆNH: ${element}`;
            
            // Chọn lời chúc
            let wish = "";
            if (wishesDB[element]) {
                wish = wishesDB[element];
            } else {
                wish = generalWishes[Math.floor(Math.random() * generalWishes.length)];
            }

            // Chạy hiệu ứng gõ chữ
            setTimeout(() => {
                typeWriter(wish, 0);
            }, 1000);
        }

        // Resize canvas
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

    </script>
</body>
</html>
